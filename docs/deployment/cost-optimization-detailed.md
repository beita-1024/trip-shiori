# コスト最適化設定

## 概要

課金額削減のため、両方の環境（本番・開発）でCloud RunとCloud SQLのコスト最適化設定を適用しています。

## 📊 現在のコスト構成

### 本番環境
| 項目 | 月額コスト | 設定内容 |
|------|------------|----------|
| Cloud SQL ディスク | ~$1.7 | 10GB PD_SSD |
| Cloud SQL バックアップ | ~$1 | 7日間保持 |
| Cloud Run リソース | ~$2 | min=0, CPU throttled |
| **本番環境小計** | **~$4.7** | |

### 開発環境
| 項目 | 月額コスト | 設定内容 |
|------|------------|----------|
| Cloud SQL ディスク | ~$0.5 | 10GB PD_STANDARD |
| Cloud SQL バックアップ | ~$0 | 無効化 |
| Cloud Run リソース | ~$1 | min=0, CPU throttled |
| **開発環境小計** | **~$1.5** | |

### 合計
| 環境 | 月額コスト |
|------|------------|
| 本番環境 | ~$4.7 |
| 開発環境 | ~$1.5 |
| **合計** | **~$6.2** |

## ⚠️ 注意事項

### パフォーマンスへの影響
- **コールドスタート**: 初回リクエスト時に起動時間が発生（通常5-10秒）
- **レスポンス時間**: アイドル状態からの復帰時に若干の遅延が発生する可能性
- **本番環境**: PD_SSD維持により高性能を確保

### 推奨事項
- 本格運用時は、必要に応じて`min_instance_count`を1に戻すことを検討
- モニタリングでレスポンス時間を監視し、必要に応じて設定を調整
- 開発環境ではバックアップ無効により、データ損失リスクを理解した上で運用

## 🔧 設定ファイル

- 本番環境: `terraform/environments/prod/main.tf`
- 開発環境: `terraform/environments/dev/main.tf`

---

_Last updated: 2025-01-15_